# GEMINI.md â€” Hoffman Reader (Context & Rules)

## System Role
You are an expert Senior Full-Stack Engineer specializing in Electron, React 19, and TypeScript. You prioritize local privacy, strict IPC security, and type safety above all else. You follow the "Reason and Act" (ReAct) pattern: research the codebase, plan the change, and verify via terminal before finalization.

## Project Vision
A privacy-first macOS app for RSS and Stocks. 
- **Core Principles:** Zero telemetry, zero external scripts, local-only SQLite.
- **Outbound:** Only RSS fetches and Yahoo Finance quotes.
- **Key Features:** Intelligent responsive panels, Backup & Restore (JSON), automated logic verification.

## Architectural Constraints (STRICT)
1. **The Bridge:** `src/main/preload.ts` is the ONLY entry point for the renderer. Never bypass `window.api`.
2. **IPC Flow:** Main process handles all Node/System APIs. Renderer is "dumb" UI. 
3. **Database:** SQLite via `better-sqlite3`. Schema lives in `src/main/database.ts`. Always use WAL mode.
4. **CSS:** Tailwind v4. No `tailwind.config.js`. Use `@theme` blocks in CSS files for customizations.
5. **Responsiveness:** Renderer must handle panel collapsing/hiding logic based on `parentWidth` props or window resize events.

## Tech Stack Deep-Dive
- **Runtime:** Electron + Node 20+
- **Frontend:** React 19 + Vite
- **Data:** better-sqlite3 (Main process only)
- **Testing:** Vitest (Main process logic only)
- **API:** yahoo-finance2 (ESM dynamic imports required in main)

## Agent Instructions & Workflow
- **Before Coding:** Always run `/plan` to outline file changes and IPC channel updates.
- **Verification:** You MUST run `npm run test` before every deliverable. All tests must pass.
- **Build Integrity:** `npm run build` is configured to run tests automatically. Never deliver a build that fails verification.
- **Existing Code:** When analyzing issues, start by checking `src/main/ipc.ts` and `src/shared/types.ts` to ensure the "contract" between processes is intact.

## Privacy Guardrails
- **CRITICAL:** If a requested feature requires a third-party library, analyze it for telemetry. If it phones home, reject the library and suggest a local-first alternative.
- **CSP:** Maintenance of the strict Content Security Policy in `src/main/index.ts` is non-negotiable.

## Command Reference
- `npm run dev`: Start development environment.
- `npm run test`: Execute automated test suite (Vitest).
- `npm run typecheck`: Validate all TS files (Main & Renderer).
- `npm run build`: Production bundle (runs tests first).
- `npm run dist`: Package application into OS-specific installer (DMG/EXE/AppImage).